/*************************************************************************
 * 
 * texteffects.c
 * 
 * (c) 2021 J. G. Silva (django) <dparicarana@gmail.com>
 * 
 * "Snake game written in C - animations, retro menu, smart snake 
 * enemies, sound effects."
 * 
 * last modification: 2021-01-07
 * 
 ************************************************************************/
 
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "uconio.h"
#include "sound.h"
#include "map.h"
#include "texteffects.h"

/* ARTE ASCII: d j a n g o */
unsigned char ascii_django[] = {
  0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x88, 0xe2,
  0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2,
  0x96, 0x84, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x84, 0xe2, 0x96,
  0x84, 0xe2, 0x96, 0x84, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96,
  0x80, 0xe2, 0x96, 0x80, 0xe2, 0x96, 0x80, 0x20, 0x20, 0x20, 0x20, 0xe2,
  0x96, 0x84, 0xe2, 0x96, 0x84, 0xe2, 0x96, 0x84, 0x20, 0x20, 0x20, 0x20,
  0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x84, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96,
  0x88, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x84, 0xe2, 0x96,
  0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0x20, 0x20,
  0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0x20, 0x20, 0x0a,
  0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88, 0xe2,
  0x96, 0x88, 0xe2, 0x96, 0x80, 0x20, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x8c, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x92,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x84, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0x20, 0x20, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0x20, 0xe2, 0x96, 0x80,
  0xe2, 0x96, 0x88, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x88, 0x20, 0x20, 0x20,
  0x20, 0x20, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x92, 0x20,
  0xe2, 0x96, 0x80, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x92, 0x20, 0x20, 0x20,
  0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x92,
  0x20, 0x20, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x92, 0x0a,
  0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0xe2, 0x96, 0x88, 0xe2,
  0x96, 0x88, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x8c, 0x20,
  0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0xe2, 0x96, 0x88, 0xe2,
  0x96, 0x88, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0xe2,
  0x96, 0x88, 0xe2, 0x96, 0x88, 0x20, 0x20, 0xe2, 0x96, 0x80, 0xe2, 0x96,
  0x88, 0xe2, 0x96, 0x84, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x93,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0x20, 0x20, 0xe2, 0x96, 0x80, 0xe2,
  0x96, 0x88, 0x20, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x92,
  0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x91, 0xe2, 0x96, 0x84, 0xe2, 0x96, 0x84, 0xe2, 0x96, 0x84,
  0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x91, 0x20, 0x20, 0xe2, 0x96, 0x88, 0xe2,
  0x96, 0x88, 0xe2, 0x96, 0x92, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2,
  0x96, 0x91, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x84, 0x20,
  0x20, 0x20, 0xe2, 0x96, 0x8c, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x93, 0xe2,
  0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x84, 0xe2, 0x96, 0x88, 0xe2,
  0x96, 0x88, 0xe2, 0x96, 0x93, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96,
  0x91, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x84, 0xe2, 0x96,
  0x84, 0xe2, 0x96, 0x84, 0xe2, 0x96, 0x84, 0xe2, 0x96, 0x88, 0xe2, 0x96,
  0x88, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x88, 0xe2,
  0x96, 0x88, 0xe2, 0x96, 0x92, 0x20, 0x20, 0xe2, 0x96, 0x90, 0xe2, 0x96,
  0x8c, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x92, 0x20, 0x20,
  0x20, 0xe2, 0x96, 0x91, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x88, 0x20, 0x20,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x93, 0x20, 0x20, 0x20,
  0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0x20, 0x20, 0x20,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x91, 0x0a, 0x20, 0x20,
  0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x93,
  0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x88, 0xe2,
  0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x92, 0x20, 0x20, 0x20, 0x20,
  0x20, 0x20, 0x20, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x88, 0x20, 0x20, 0x20,
  0xe2, 0x96, 0x93, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x92,
  0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91,
  0xe2, 0x96, 0x92, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88,
  0xe2, 0x96, 0x88, 0xe2, 0x96, 0x80, 0xe2, 0x96, 0x92, 0x20, 0x20, 0x20,
  0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96,
  0x88, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x92, 0xe2, 0x96,
  0x91, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0xe2,
  0x96, 0x92, 0xe2, 0x96, 0x93, 0x20, 0x20, 0xe2, 0x96, 0x92, 0x20, 0x20,
  0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x93, 0xe2, 0x96, 0x92,
  0xe2, 0x96, 0x92, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0x20, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x92, 0x20, 0x20, 0x20, 0xe2, 0x96,
  0x93, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x88, 0xe2, 0x96, 0x91, 0x20, 0x20,
  0x20, 0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x91, 0x20,
  0x20, 0x20, 0xe2, 0x96, 0x92, 0x20, 0xe2, 0x96, 0x92, 0x20, 0x20, 0x20,
  0x20, 0x20, 0xe2, 0x96, 0x91, 0xe2, 0x96, 0x92, 0x20, 0x20, 0x20, 0xe2,
  0x96, 0x92, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96,
  0x92, 0xe2, 0x96, 0x91, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x91, 0xe2, 0x96,
  0x92, 0xe2, 0x96, 0x91, 0x20, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96, 0x92, 0x20, 0x20, 0xe2, 0x96, 0x92,
  0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0x20, 0xe2, 0x96, 0x91,
  0xe2, 0x96, 0x92, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0x20, 0x20, 0xe2, 0x96, 0x92, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0xe2,
  0x96, 0x92, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91,
  0x20, 0xe2, 0x96, 0x91, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0xe2, 0x96,
  0x91, 0x20, 0xe2, 0x96, 0x92, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0x20,
  0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20,
  0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96, 0x92, 0x20,
  0xe2, 0x96, 0x92, 0xe2, 0x96, 0x91, 0x20, 0x0a, 0x20, 0x20, 0x20, 0x20,
  0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0xe2,
  0x96, 0x91, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0xe2,
  0x96, 0x91, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x92, 0x20,
  0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20,
  0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20,
  0x20, 0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0xe2,
  0x96, 0x91, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96,
  0x91, 0x20, 0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96, 0x92, 0x20, 0x20, 0x0a,
  0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20,
  0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20,
  0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0xe2, 0x96, 0x91,
  0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
  0xe2, 0x96, 0x91, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x0a, 0x20, 0x20,
  0x20, 0x20, 0x20, 0x20, 0xe2, 0x96, 0x91, 0x20, 0x20, 0x0a
};

/* Imprime texto com efeito rolagem horizontal da esquerda para a direita
 * a partir da posição de referência pré definida (x, y) */
void texteffect_bigscrollH(char *_str[], const int l, int _length)
{
		int i,j;
	int head;
	int n = strlen(_str[0]);
	char *str[l];
	
	// +3 espaço inicial, final '\0'
	for(i = 0; i < l; i++)
		str[i] = (char *) malloc((_length+n+3)*sizeof(char));

	// adicionar espaços nas strings
	for(i = 0; i < l; i++)	{
		for(j = 0; j <=_length; j++)
			str[i][j] = ' ';
		for(j = 0; j < n; j++)
			str[i][_length+1+j] = _str[i][j];
		str[i][_length + 1 + n] = ' ';
		str[i][_length + 2 + n] = '\0';
	}

	// imprimir fazendo rolagem
	n = strlen(str[0]);
	// não imprimir os primeiros caracteres (head)
	for(head = 0; head < n; head++)	{ 
		// limpa definições anteriores e reposiciona cursor
		printf("\x1b[0m\x1b[2J"); 
		for(i=0; i<l; i++)	{			
			// imprime caracteres
			printf("%.*s",_length,str[i]+head);
			// reposiciona cursor
			printf("\x1b[0m\n");
		}
		//usleep(40000);
		delay(27);
	}

	for(i=0; i<l; i++)
		free(str[i]);
}

char **converttexttoarray(char *path, int *n)
{
		FILE *f = fopen(path,"r");
	char *line=NULL;
	int i;
	size_t len,plen=0;
	ssize_t read;
	char *linhas[100];

	// erro ao tentar abrir ficheiro para posterior leitura?
	if(!f)
	{
		textcolor(RED);
		printf("\n[ERRO] Impossivel abrir o ficheiro %s para leitura.\n", path);
		return(NULL);
	}

	// lê o conteúdo de cada linha e os copia para o array de strings.
	for(i = 0; ((read = getline(&line, &len, f)) != -1 ) && i < 100; i++)	
	{		
		if(strlen(line)==1)	
		{
			free(line);
			break;
		// verifica se cada uma das linhas possuem o mesmo comprimento,
		// isto é, o mesmo número de caracteres.
		} else if(plen!=0 && len!=plen)	{ 
			textcolor(RED);
			printf("[ERRO] As linhas %d and %d do ficheiro %s diferem quanto ao compriento (%zu and %zu)\n.", i, i - 1, path, len, plen);
			return NULL;
		}

		// Remove o "\n" do final da linha
		int j;
		for(j = 0; j < (int)len; j++)
			if(line[j]=='\n') 
			{
				line[j]='\0';
			}

		linhas[i] = line;	
		
		plen=len;
		line = NULL;
	}
	
	*n=i;
	char **dest = (char **) malloc(*n * sizeof(void *));
	for(i = 0; i < *n; i++)
		dest[i] = linhas[i];

	return dest;
}


/* Imprime texto com efeito rolagem dupla horizontal. Note que:
 * 
 * direction = 0: <---->
 * direction = 1: --><--
 * 
 * (!) O presente procedimento funciona normalmente apenas para strings
 * de tamanho PAR. */
void texteffect_scrollHD(const int x, const int y, char *text,
	char direction, int txtcolor, int bkgcolor)
{
	unsigned int i;
	char *text1, *text2;
	// captura metades anterior e posterior do texto, respectivamente
	text1 = strndup(text, strlen(text)/2);
	text2 = strndup(text + strlen(text)/2, strlen(text)/2);
	// imprime textos em direções opostas e com efeito rolagem horizontal
	if (direction == 0)
	{
		for (i = 1; i < strlen(text)/2 + 1; i++)
		{
			textbackground(bkgcolor);textcolor(txtcolor);
			gotoxy(x, y);
			printf("%s", text1 + strlen(text1) - i);
			gotoxy(x + strlen(text) - i, y);
			printf("%.*s", i, text2);
			/* (BUG): No ubuntu 14.04, se o usuário pressiona alguma tecla
			 * durante a execução deste procedimento, então códigos
			 * indesejáveis aparecem no terminal (Por exemplo: "^[[A") */
			/*(!)*/textbackground(BLACK);textcolor(DARKGREY);gotoxy(1, 24);
			delay(45);
		}
	} else {
		for (i = 1; i < strlen(text)/2 + 1; i++)
		{
			textbackground(bkgcolor);textcolor(txtcolor);
			gotoxy(x + strlen(text1) - i, y);
			printf("%.*s", i, text1);
			gotoxy(x + strlen(text2), y);
			printf("%s", text2 + strlen(text2) - i);
			/* (BUG): No ubuntu 14.04, se o usuário pressiona alguma tecla
			 * durante a execução deste procedimento, então códigos
			 * indesejáveis aparecem no terminal (Por exemplo: "^[[A") */
			/*(!)*/textbackground(BLACK);textcolor(DARKGREY);gotoxy(1, 24);
			delay(45);
		}
	}	
	textattr(RESETATTR);
}

/* Imprime texto com efeito "adição de letras" */
void texteffect_addchar(const int x, const int y, char *text,
	int txtcolor, int bkgcolor)
{
	textbackground(bkgcolor);textcolor(txtcolor);
	int i, j, index, length;	
	length = (int)strlen(text);
	char print_string[length + 1];
	memset(print_string, ' ', length);
	print_string[length] = '\0';
	for (index = 0; index < length; index++)
	{
		if (text[index] == ' ')
		{
			print_string[index] = ' ';
			continue;
		}
		i = length - 1;
		while( i >= index)
		{
			print_string[i] = text[index];
			for (j = 0; j <= 50; j++)
			{
				gotoxy(x, y);
				printf("%s\r", print_string);
				usleep((unsigned)(1500/(length - index)));
			}
			if (i != index)
			{
				print_string[i] = ' ';
			}
			i--;
		}
	}
	gotoxy(x, y);
	printf("%s\n", print_string);
	textattr(RESETATTR);
}

/* Exibe animação ASCII de introdução do jogo */
void texteffect_introanim()
{	
	int i; // variável auxiliar
	// Apresentação...
	audio_play(audio_mainchannel, AUDIO_TEFX_SLIDING, FALSE);
	texteffect_scrollHD(24,  4,  "UNIVERSIDADE FEDERAL DE  RORAIMA", 1, LIGHTGREEN, BLACK);
	audio_play(audio_mainchannel, AUDIO_TEFX_SLIDING, FALSE);
	texteffect_scrollHD(21,  5,  "DEPARTAMENTO  DE CIENCIA DA COMPUTACAO", 1, LIGHTGREEN, BLACK);
	audio_play(audio_mainchannel, AUDIO_TEFX_SLIDING, FALSE);
	texteffect_scrollHD(28,  6,  "PROGRAMACAO  ESTRUTURADA", 1, LIGHTGREEN, BLACK);
	audio_play(audio_mainchannel, AUDIO_TEFX_SLIDING, FALSE);
	texteffect_scrollHD(36, 20,  "Mar/2016", 1, LIGHTGREEN, BLACK);
	audio_play(audio_mainchannel, AUDIO_TEFX_SLIDING, FALSE);
	texteffect_scrollHD(33, 19,  "Boa Vista,  RR", 1, LIGHTGREEN, BLACK);
	audio_play(audio_mainchannel, AUDIO_TEFX_SLIDING, FALSE);
	texteffect_scrollHD(29,  8,  "Prof.  Dion Laranjeira", 0, YELLOW, BLACK);
	texteffect_addchar(24,  10,  "Aluno:  Janderson Gomes da Silva", LIGHTCYAN, BLACK);
	texteffect_addchar(32,  11,  "Mat.: 2201514716", LIGHTCYAN, BLACK);
	texteffect_addchar(28,  14,  "3ª LISTA DE EXERCÍCIOS", WHITE, BLACK);delay(1000);	
	//audio_play(audio_mainchannel, AUDIO_TEFX_SLIDINGTOC, TRUE);
	texteffect_scrollHD(28, 14,  "  pense diferente :o) ", 0, LIGHTRED, BLACK);delay(1000);
	audio_stop(); audio_resume();
	for (i = 0; i < 22; i++)
	{
		gotoxy(28, 14);
		if (i % 2 == 0)
		{
			puts("  \x1B[31mp\x1B[36men\x1B[31ms\x1B[36me d\x1B[31mi\x1B[36mfe\x1B[31mr\x1B[36men\x1B[31mt\x1B[36me :\x1B[31mo\x1B[36m) ");
		} else {
			puts("  \x1B[36mpe\x1B[31mn\x1B[36mse\x1B[31m d\x1B[36mif\x1B[31me\x1B[36mre\x1B[31mn\x1B[36mte\x1B[31m :\x1B[36mo) ");
		}
		delay(100);
	}
	
	// Reproduz áudio de introdução
	audio_play(audio_mainchannel, AUDIO_INTRO, FALSE);
	
	// UFRR
	char **ascii_ufrrengeletrica; // array contendo arte ASCII
	int ascii_ufrrengeletrica_length = 0; // dimensão do array acima
	ascii_ufrrengeletrica = converttexttoarray(
		"asciiarts/ufrr.ans",
		&ascii_ufrrengeletrica_length
	);
	texteffect_bigscrollH(
		ascii_ufrrengeletrica, ascii_ufrrengeletrica_length, 80
	);
	free(ascii_ufrrengeletrica);
	
	// django
	textcolor(LIGHTRED); gotoxy(1, 8); 
	printf("%s", ascii_django); delay(2000);
	
	// Reproduz áudio rizada maligna
	audio_play(audio_mainchannel, AUDIO_DJANGO, FALSE); delay(500);
	for (i = 0; i < 8; i++)
	{
		gotoxy(1, 8 - i);
		if (i % 2 == 0) {textcolor(LIGHTRED);} else {textcolor(RED);}
		printf("%s", ascii_django);
		delay(500);
	}
	
	audio_stop(); audio_resume();
}

/* Exibe animação de contagem regressiva para início de partida */
void texteffect_countdownanim(Map *map)
{
	int i, j;		
	//audio_stop(); audio_resume();
	//audio_play(channel_main, AUDIO_MAP_1);
	textbackground(BLACK); textcolor(WHITE);
	gotoxy(38, 10); printf(" _  _   "); 
	gotoxy(38, 11); printf("| || |  "); 
	gotoxy(38, 12); printf("| || |_ "); 
	gotoxy(38, 13); printf("|__   _|"); 
	gotoxy(38, 14); printf("   | |  "); 
	gotoxy(38, 15); printf("   |_|  ");
	delay(1000);
	gotoxy(38, 10); printf(" _____  ");
	gotoxy(38, 11); printf("|___  | ");
	gotoxy(38, 12); printf("  __) | ");
	gotoxy(38, 13); printf(" |__ <  ");
	gotoxy(38, 14); printf(" ___) | ");
	gotoxy(38, 15); printf("|____/  ");
	delay(1000);
	gotoxy(38, 10); printf("  ___   ");
	gotoxy(38, 11); printf(" |__  | ");
	gotoxy(38, 12); printf("    ) | ");
	gotoxy(38, 13); printf("   / /  ");
	gotoxy(38, 14); printf("  / /_  ");
	gotoxy(38, 15); printf(" |____| ");
	delay(1000);
	gotoxy(38, 10); printf("   __   ");
	gotoxy(38, 11); printf("  /_ |  ");
	gotoxy(38, 12); printf("   | |  ");
	gotoxy(38, 13); printf("   | |  ");
	gotoxy(38, 14); printf("   | |  ");
	gotoxy(38, 15); printf("   |_|  "); 
	delay(1000);
	//gotoxy(38, 10); printf(" _____  "); 
	//gotoxy(38, 11); printf("| ____| "); 
	//gotoxy(38, 12); printf("| |___  "); 
	//gotoxy(38, 13); printf("|___  | "); 
	//gotoxy(38, 14); printf(" ___) | "); 
	//gotoxy(38, 15); printf("|____/  "); 
	delay(1000);
	for (j = 0; j < 7; j++)
	{
		for (i = 0; i < 8; i++)
		{
			map_drawobject(38 + i - map->x, 10 + j - map->y, map);
		}		
	}
}
